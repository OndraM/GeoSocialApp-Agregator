    <form id="searchform">
        <label>Latitude: <input type="text" name="lat" value="50.076738" /></label><br />
        <label>Longitude: <input type="text" name="long" value="14.41803" /></label><br />
        <label>Filter name: <input type="text" name="term" value="" /></label><br />
        <input type="submit" value="Submit" />
    </form>

    <div id="venues-wrapper">
        <div id="venues-map">
        </div>
        
        <div id="venues-list">
        </div>
    </div>

<?php
$url = $this->url(array('controller' => 'poi', 'action' => 'get-nearby'), 'default', true);
$this->script("
$('#searchform').submit(function() {
    $('#venues-list').html('<ul><li><img src=\"" . $this->baseUrl() . "/images/spinner.gif\" alt=\"\" /> Loading...</li></ul>');
    $.getJSON('$url?' + $('#searchform input[type=text]').serialize(), function(data) { 
        if (typeof(data) == 'object'
                && typeof(data.venues) != 'undefined'
                && data.venues.length > 0) {
            var items = [];
            $.each(data.venues, function(key, val) {
                items.push('<li id=\"' + val.id + '\">' + val.name + '</li>');
            });

            $('#venues-list').html(
                $('<ul/>', {
                    html: items.join('')
                })
            );
        } else {
            $('#venues-list').html('<p>Sorry, no matching places nearby.</p>');
        }
        
    });
    setMapCenter( $('#searchform input[name=lat]').val(), $('#searchform input[name=long]').val());
    return false;
});

doGeolocate();
$('#searchform').submit();

");


$this->script("

mapInit();

")
?>

